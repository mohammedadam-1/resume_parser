<div class="container">
    <h2>üíº Apply for a Job</h2>
    <form id="applyForm" enctype="multipart/form-data">
        <label>Select Job:</label>
        <select name="job_id" required>
            {% for job in jobs %}
            <option value="{{ job.id }}">{{ job.title }}</option>
            {% endfor %}
        </select>
        <label>Name:</label>
        <input type="text" name="name" placeholder="Your Name" required>
        <label>Email:</label>
        <input type="email" name="email" placeholder="Your Email" required>
        <label>Phone:</label>
        <input type="text" name="phone" placeholder="Your Phone" required>
        <label>Upload Resume:</label>
        <input type="file" name="resume" accept=".pdf,.docx,.txt" required>
        <button type="submit">Submit Application</button>
    </form>

    <div id="loader"></div>
    <div id="result"></div>
</div>

<script>
const form = document.getElementById('applyForm');
const loader = document.getElementById('loader');
const result = document.getElementById('result');

form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);

    loader.style.display = "block";
    result.innerHTML = "";

    try {
        const response = await fetch('/apply', { method: 'POST', body: formData });
        const text = await response.text();  // Server returns plain text

        loader.style.display = "none";
        result.innerHTML = `<p class="pass">${text}</p>`; // Styled success message

    } catch (err) {
        loader.style.display = "none";
        result.innerHTML = "<p class='fail'>‚ùå Error submitting application. Please try again.</p>";
    }
});
</script>

<style>
    body { font-family: Arial; background:#f5f6fa; padding: 30px; }
    .container { max-width:600px; margin:auto; background:white; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
    select, input, button { width:100%; padding:10px; margin-top:10px; border-radius:5px; border:1px solid #ccc; }
    button { background:#0984e3; color:white; border:none; cursor:pointer; }
    button:hover { background:#74b9ff; }
    #loader { display:none; margin:20px auto; border:6px solid #f3f3f3; border-top:6px solid #0984e3; border-radius:50%; width:40px; height:40px; animation: spin 1s linear infinite; }
    @keyframes spin { 0%{transform:rotate(0deg);} 100%{transform:rotate(360deg);} }
    .pass { color: green; font-weight:bold; font-size:16px; }
    .fail { color: red; font-weight:bold; font-size:16px; }
</style>
